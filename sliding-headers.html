<!DOCTYPE html>
<html>
<head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Sliding Headers Prototype</title>
    <style>

        html,
        body {
            margin: 0;
            padding: 0;
            background: #333
        }


        .calendar {
            overflow-x: scroll;
            overflow-y: hidden;
            white-space: nowrap;
            font-size: 0;
            position: relative;
        }

        .month {
            background: none repeat scroll 0 0 orange;
            display: inline-block;
            position: relative;
            font-size: 16px;
            outline: 1px dotted brown;
            outline-width: 0 1px;
        }

        .month > ol {
            margin-top: 40px;
            padding: 0;
        }

        .day {
            width: 200px;
            margin: 0 20px;
            display: inline-block;
            list-style: none outside none;
            position: relative;
            background: pink;
            vertical-align: top;
        }

        .month > .name {
            margin: 0;
            position: absolute;
            top: 0;
            padding:0 20px;
            color: Chocolate;
            transition: color 0.5s 0s;
        }

        .month.middle > .name {
            left: 550px;
            position: fixed;
            /*top: 0;*/
            color: black;
        }

        .month.begining > .name {
            position: absolute;
            right: auto;
            left: 0;
            /*left: 20px;*/
        }

        .month > .name,
        .month.end > .name {
            position: absolute;
            right: 0;
            /*right: 20px;*/
            left: auto;
        }


        .day time,
        .day .events {
            width: 200px;
        }

        .day time {
            position: relative;
            display: block;
            height: 200px;
            background: ivory;
        }

        .day .events {
            position: relative; /*TODO*//*do i need this?*/
        }


        #scrimmage,
        #zeroLine {
            position: fixed;
            top: 0;
            left: 550px;
            width: 0;
            height: 100%;
            border-left: 1px solid purple;
            z-index: 1;
        }

    </style>
</head>
<body class="">
    <div class="calendar">
        <div id="zeroLine"></div>
        <!-- TODO: add section.year and section.year time .name -->
        <!-- TODO: maybe add the computer-readable time -->
        <section class="month march">
            <h1 class="name">March</h1>
            <ol id="events" start="">
                <li class="day wednesday">
                    <time>
                        <span class="name">Wednesday</span>
                        <span class="date">20</span>
                    </time>
                    <ol class="events">
                        <li class="">neat</li>
                    </ol>
                </li>
                <li class="day thursday current">
                    <time>
                        <span class="name">Thursday</span>
                        <span class="date">21</span>
                    </time>
                    <ol class="events">
                        <li class="">hi there</li>
                        <li class="">neat</li>
                        <li class="add">+</li>
                    </ol>
                </li>
                <li class="day friday">
                    <time>
                        <span class="name">Friday</span>
                        <span class="date">22</span>
                    </time>
                    <ol class="events">
                        <li class="add">+</li>
                    </ol>
                </li>
                <li class="day saturday">
                    <time>
                        <span class="name">Friday</span>
                        <span class="date">22</span>
                    </time>
                    <ol class="events">
                        <li class="add">+</li>
                    </ol>
                </li>
                <li class="day sunday">
                    <time>
                        <span class="name">Friday</span>
                        <span class="date">22</span>
                    </time>
                    <ol class="events">
                        <li class="add">+</li>
                    </ol>
                </li>
            </ol>
        </section>

        <section class="month april">
            <h1 class="name">April</h1>
            <ol id="events" start="">
                <li class="day wednesday">
                    <time>
                        <span class="name">Wednesday</span>
                        <span class="date">20</span>
                    </time>
                    <ol class="events">
                        <li class="">neat</li>
                    </ol>
                </li>
                <li class="day thursday current">
                    <time>
                        <span class="name">Thursday</span>
                        <span class="date">21</span>
                    </time>
                    <ol class="events">
                        <li class="">hi there</li>
                        <li class="">neat</li>
                        <li class="add">+</li>
                    </ol>
                </li>
                <li class="day friday">
                    <time>
                        <span class="name">Friday</span>
                        <span class="date">22</span>
                    </time>
                    <ol class="events">
                        <li class="add">+</li>
                    </ol>
                </li>
                <li class="day saturday">
                    <time>
                        <span class="name">Friday</span>
                        <span class="date">22</span>
                    </time>
                    <ol class="events">
                        <li class="add">+</li>
                    </ol>
                </li>
                <li class="day sunday">
                    <time>
                        <span class="name">Friday</span>
                        <span class="date">22</span>
                    </time>
                    <ol class="events">
                        <li class="add">+</li>
                    </ol>
                </li>
            </ol>
        </section>

        <section class="month may">
            <h1 class="name">May</h1>
            <ol id="events" start="">
                <li class="day wednesday">
                    <time>
                        <span class="name">Wednesday</span>
                        <span class="date">20</span>
                    </time>
                    <ol class="events">
                        <li class="">neat</li>
                    </ol>
                </li>
                <li class="day thursday current">
                    <time>
                        <span class="name">Thursday</span>
                        <span class="date">21</span>
                    </time>
                    <ol class="events">
                        <li class="">hi there</li>
                        <li class="">neat</li>
                        <li class="add">+</li>
                    </ol>
                </li>
                <li class="day friday">
                    <time>
                        <span class="name">Friday</span>
                        <span class="date">22</span>
                    </time>
                    <ol class="events">
                        <li class="add">+</li>
                    </ol>
                </li>
                <li class="day saturday">
                    <time>
                        <span class="name">Friday</span>
                        <span class="date">22</span>
                    </time>
                    <ol class="events">
                        <li class="add">+</li>
                    </ol>
                </li>
                <li class="day sunday">
                    <time>
                        <span class="name">Friday</span>
                        <span class="date">22</span>
                    </time>
                    <ol class="events">
                        <li class="add">+</li>
                    </ol>
                </li>
            </ol>
        </section>

        <section class="month june">
            <h1 class="name">June</h1>
            <ol id="events" start="">
                <li class="day wednesday">
                    <time>
                        <span class="name">Wednesday</span>
                        <span class="date">20</span>
                    </time>
                    <ol class="events">
                        <li class="">neat</li>
                    </ol>
                </li>
                <li class="day thursday current">
                    <time>
                        <span class="name">Thursday</span>
                        <span class="date">21</span>
                    </time>
                    <ol class="events">
                        <li class="">hi there</li>
                        <li class="">neat</li>
                        <li class="add">+</li>
                    </ol>
                </li>
                <li class="day friday">
                    <time>
                        <span class="name">Friday</span>
                        <span class="date">22</span>
                    </time>
                    <ol class="events">
                        <li class="add">+</li>
                    </ol>
                </li>
                <li class="day saturday">
                    <time>
                        <span class="name">Friday</span>
                        <span class="date">22</span>
                    </time>
                    <ol class="events">
                        <li class="add">+</li>
                    </ol>
                </li>
                <li class="day sunday">
                    <time>
                        <span class="name">Friday</span>
                        <span class="date">22</span>
                    </time>
                    <ol class="events">
                        <li class="add">+</li>
                    </ol>
                </li>
            </ol>
        </section>

        <section class="month july">
            <h1 class="name">July</h1>
            <ol id="events" start="">
                <li class="day wednesday">
                    <time>
                        <span class="name">Wednesday</span>
                        <span class="date">20</span>
                    </time>
                    <ol class="events">
                        <li class="">neat</li>
                    </ol>
                </li>
                <li class="day thursday current">
                    <time>
                        <span class="name">Thursday</span>
                        <span class="date">21</span>
                    </time>
                    <ol class="events">
                        <li class="">hi there</li>
                        <li class="">neat</li>
                        <li class="add">+</li>
                    </ol>
                </li>
                <li class="day friday">
                    <time>
                        <span class="name">Friday</span>
                        <span class="date">22</span>
                    </time>
                    <ol class="events">
                        <li class="add">+</li>
                    </ol>
                </li>
                <li class="day saturday">
                    <time>
                        <span class="name">Friday</span>
                        <span class="date">22</span>
                    </time>
                    <ol class="events">
                        <li class="add">+</li>
                    </ol>
                </li>
                <li class="day sunday">
                    <time>
                        <span class="name">Friday</span>
                        <span class="date">22</span>
                    </time>
                    <ol class="events">
                        <li class="add">+</li>
                    </ol>
                </li>
            </ol>
        </section>

        <div id="results">

        </div>
    </div>
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script>
            $(document).ready(function(){

                // can I reduce the number of vars needed?
                var calendar = $('.calendar'),
                    calendarLeft, // I might need this for calculating the month names in layouts that dont have the calendars left at zero.
                    months = $('.month'), // will need to be updated every time I load more days into the calendar.
                    monthNames = months.find('> .name'),
                    zeroLine = $('#zeroLine').position().left, // by using an elem instead of a number I can adjust the zeroLine via mediaQuery
                    beforeZero,
                    afterZero,
                    monthslefts = [],
                    monthNamesRights = [],
                    pastBeforeZero = null;

                function init() {

                    calendar.scrollLeft(0); // scroll back to zero so that the month lefts arent offset by the scroll position
                    // move into a function, rebuild the data after each time I add days to the calendar.
                    // collect data on the months loaded into the calendar. this should be done every time I load more days into the calendar.
                    var mLen = months.length;
                    while(mLen--){
                        monthslefts[mLen] = $(months[mLen]).position().left; // get the left edge of the month block
                        monthNamesRights[mLen] = $(monthNames[mLen]).outerWidth(); // get the width to find the right edge of the month's heading (so I know when to start pushing it out of the way)
                    }

                    calendar.scroll(function(){
                        var scrollZero = calendar.scrollLeft() + zeroLine; // consider factoring in calendarLeft
                        // perhaps I could do some kind of while(outOfRange(..))
                        // console.log('monthslefts.length: ', monthslefts.length);
                        for(var i=0, l=monthslefts.length; i < l; i++) {
                            if( monthslefts[i] > scrollZero ) {
                                beforeZero = i-1;
                                afterZero  = i;
                                break;
                            }
                        }

                        if(pastBeforeZero !== beforeZero) { // only do this work when the focused month changes
                            // console.log('(monthslefts[afterZero] - monthNamesRights[beforeZero]): ', (monthslefts[afterZero] - monthNamesRights[beforeZero]) );
                            // console.log('afterZero: ', afterZero);
                            if( ((monthslefts[afterZero] - monthNamesRights[beforeZero]) || scrollZero+1) < scrollZero) {
                                // if the month on the right side of the zeroLine starts on the left side
                                $(months[beforeZero]).removeClass('begining middle').addClass('end');
                            }else{
                                $(months[beforeZero]).removeClass('begining end').addClass('middle');
                            }
                            $(months[afterZero]).removeClass('middle end').addClass('begining');

                        }
                    });//scroll end

                    calendar.scrollLeft(1).scrollLeft(0); // this kicks the month name positions

                }//init end

                init();

            });
    </script>

</body>
</html>
